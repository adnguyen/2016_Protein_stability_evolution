{
    "contents" : "---\ntitle: \"Unfolding_curves\"\nauthor: \"Antdrew D. Nguyen\"\ndate: \"2016-April-26\"\noutput: pdf_document\n---\n\n#Loading libraries and functions\n```{r}\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(minpack.lm)\n\nnls.fit<-function(data=data){\n  y<-nlsLM(unfolding ~ min+ (1-min)/(1+exp((-slope*(Tm-T)))),data=data, \n           start=list(slope=.5,Tm=45,min=.3),\n           trace=TRUE,control=nls.control(warnOnly = TRUE, tol = 1e-05, maxiter=1000))\n  #return(y)\n  return(summary(y)$coefficients)\n  }\n\n\n#Function that predicts values given parameter estimates of curves\nfud<-function(T=seq(25,50,1),Tm=40,slope=.5,max=1,min=0){\n  y<-min+ (max-min)/(1+exp((-slope*(Tm-T))))\n  return(y)\n  }\n\n```\n\n#Comparing aphaeno and pogo\n```{r comparing pogo and aphaeno}\n#pogo\nT<-c(25,30,35,40,43,45,48,50,55,60,65,70)\nten<-c(1.00,0.984,0.974,0.795,0.787,0.726,0.640,0.574,0.482,0.379,0.387,0.392)\nten.dat<-as.data.frame(cbind(T,ten));names(ten.dat)[2]<-\"unfolding\"\nunfold_10min<-nls.fit(ten.dat)\n#Aphaeno\navon<-c(0.963,1.00,0.940,0.882,0.755,0.627,0.600,0.549,0.502,0.444,0.368,0.379)\naph<-as.data.frame(cbind(T,avon));names(aph)[2]<-\"unfolding\"\naph.fit<-nls.fit(aph)\n#Table of fitted curves\nknitr::kable(round(cbind(unfold_10min,aph.fit),3))\n#difference in TMs\n46.16-44.754\n\n\n#lets plot these out with all parameters\nplot(seq(25,70,.1),fud(T=seq(25,70,.1),max=1,min=0.3958177,Tm=44.7544257,slope=0.2156598),pch=16,col=\"blue\",ylab=\"Proportion non-denatured\",xlab=\"Temperature\",ylim=c(.3,1))\npoints(seq(25,70,.1),fud(T=seq(25,70,.1),max=1,min=0.3704093,Tm=46.159662,slope=0.1923073),pch=16,col=\"red\")\npoints(ten.dat$T,ten.dat$unfolding,pch=16,col=\"red\",cex=2)\npoints(aph$T,aph$unfolding,pch=16,col=\"blue\",cex=2)\nlegend(55,1,c(\"Pogonomyrmex barbatus\",\"Aphaenogaster picea\"),text.font=3,pch=16,col=c(\"red\",\"blue\"))\n#abline(v=c(46.1596629,44.7544257),lty=c(1,3),lwd=3)\n\n##plot by only slope\nplot(seq(25,70,.1),fud(T=seq(25,70,.1),slope= 0.192,Tm=45),pch=16,col=\"blue\",ylab=\"Proportion non-denatured\",xlab=\"Temperature\")\npoints(seq(25,70,.1),fud(T=seq(25,70,.1),slope= 0.216,Tm=45),pch=16,col=\"red\")\nlegend(55,1,c(\"Pogonomyrmex barbatus\",\"Aphaenogaster picea\"),text.font=3,pch=16,col=c(\"red\",\"blue\"))\n```\n\n\n#comparing 10 vs 20 min\n```{r comparing the 10 min vs 20 min at each temp}\n# 10 min inc\n#earlier\nunfold_10min<-nls.fit(ten.dat)\n# 20 min incubation\ntwen<-c(0.977,0.988,1.00,0.822,0.664,0.564,0.479,0.473,0.432,0.350,0.315,0.304)\nty.dat<-as.data.frame(cbind(T,twen));names(ty.dat)[2]<-\"unfolding\"\nunfold_20min<-nls.fit(ty.dat);unfold_20min\n\nknitr::kable(round(cbind(unfold_10min,unfold_20min),3))\n\n#plots\n\n\nplot(seq(25,70,.1),fud(T=seq(25,70,.1),max=1,min=0.3452337,Tm=43.2788185,slope=0.2824321),pch=16,col=\"red\",ylab=\"Proportion non-denatured\",xlab=\"Temperature\",ylim=c(.3,1))\npoints(seq(25,70,.1),fud(T=seq(25,70,.1),max=1,min=0.3704093,Tm=46.159662,slope=0.1923073),pch=16,col=\"black\")\npoints(ten.dat$T,ten.dat$unfolding,pch=16,col=\"black\",cex=2)\npoints(ty.dat$T,ty.dat$unfolding,pch=16,col=\"red\",cex=2)\nabline(v=c(46.1596629,43.2788185),lty=c(1,3),lwd=3)\nlegend(55,1,c(\"10 minute\",\"20 minute\"),pch=16,col=c(\"black\",\"red\"))\n\n```\n\n",
    "created" : 1461698690533.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2563467464",
    "id" : "84A424F6",
    "lastKnownWriteTime" : 1461703799,
    "path" : "~/zScience/Dissertation_temperature_adaptation_ants/Dissertation_Projects/2016_Protein_stability_evolution/Script_analysis/20160426_unfolding_curves_preliminary_play.Rmd",
    "project_path" : "20160426_unfolding_curves_preliminary_play.Rmd",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}