{
    "contents" : "---\ntitle: \"Unfolding_curves\"\nauthor: \"Antdrew D. Nguyen\"\ndate: \"2016-April-26\"\noutput: pdf_document\n---\n$min + \\frac{1-min}{(1+e^{(-slope(Tm-Temp))})}$\n\n#Loading libraries and functions\n```{r}\nlibrary(plyr)\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(minpack.lm)\n\nnls.fit<-function(data=data){\n  y<-nlsLM(unfolding ~ min+ (1-min)/(1+exp((-slope*(Tm-T)))),data=data, \n           start=list(slope=.5,Tm=45,min=.3),\n           trace=TRUE,control=nls.control(warnOnly = TRUE, tol = 1e-05, maxiter=1000))\n  #return(y)\n  return(summary(y)$coefficients)\n  }\n\n\n#Function that predicts values given parameter estimates of curves\nfud<-function(T=seq(25,70,1),Tm=40,slope=.5,max=1,min=0){\n  y<-min+ (max-min)/(1+exp((-slope*(Tm-T))))\n  return(y)\n  }\n\nplot(seq(25,70,1),fud(slope=.15),col=\"blue\",pch=16,las=1,ylim=c(0,1),ylab=\"Proportion non-denatured\",xlab=\"Temperature\")# aphaeno\npoints(seq(25,70,1),fud(,slope=.2),col=\"red\",pch=15)#pogo\nlegend(50,1,c(\"pogo\",\"rudis\"),pch=c(15,16),col=c(\"red\",\"blue\"))\n```\n\n#20160520\n```{r total protein}\nx<-read.csv(\"../Data/20160520_total_protein_unfolding.csv\")\nx.par<-subset(x,x$TN==\"N\" & x$Species!=\"A. picea\")\n\nstr(x.par)\n\nx.par\n\nmod1<-ddply(x.par,.(Species,Colony),nls.fit)\nmod1$parameter<-rep(c(\"slope\",\"Tm\",\"min\"),length(mod1$Species)/3)\nknitr::kable(mod1)\n\nTm<-subset(mod1,mod1$parameter==\"Tm\")\nTm\nsummary(aov(Estimate~Species,data=Tm))\n\nslope<-subset(mod1,mod1$parameter==\"slope\")\nslope\nsummary(aov(Estimate~Species,data=slope))\nboxplot(Estimate~Species,data=slope,las=1,ylab=\"slope parameter\")\n\n\nmin<-subset(mod1,mod1$parameter==\"min\")\nmin\nsummary(aov(Estimate~Species,data=min))\n\nggplot(x.par,aes(x=T,y=unfolding,colour=Species))+geom_point()\n```\n\n\n#Comparing aphaeno and pogo\n```{r comparing pogo and aphaeno, eval=FALSE}\n#pogo\nT<-c(25,30,35,40,43,45,48,50,55,60,65,70)\nten<-c(1.00,0.984,0.974,0.795,0.787,0.726,0.640,0.574,0.482,0.379,0.387,0.392)\nten.dat<-as.data.frame(cbind(T,ten));names(ten.dat)[2]<-\"unfolding\"\nunfold_10min<-nls.fit(ten.dat)\n#Aphaeno\navon<-c(0.963,1.00,0.940,0.882,0.755,0.627,0.600,0.549,0.502,0.444,0.368,0.379)\naph<-as.data.frame(cbind(T,avon));names(aph)[2]<-\"unfolding\"\naph.fit<-nls.fit(aph)\n#Table of fitted curves\nknitr::kable(round(cbind(unfold_10min,aph.fit),3))\n#difference in TMs\n46.16-44.754\n\n\n#lets plot these out with all parameters\nplot(seq(25,70,.1),fud(T=seq(25,70,.1),max=1,min=0.3958177,Tm=44.7544257,slope=0.2156598),pch=16,col=\"blue\",ylab=\"Proportion non-denatured\",xlab=\"Temperature\",ylim=c(.3,1))\npoints(seq(25,70,.1),fud(T=seq(25,70,.1),max=1,min=0.3704093,Tm=46.159662,slope=0.1923073),pch=16,col=\"red\")\npoints(ten.dat$T,ten.dat$unfolding,pch=16,col=\"red\",cex=2)\npoints(aph$T,aph$unfolding,pch=16,col=\"blue\",cex=2)\nlegend(55,1,c(\"Pogonomyrmex barbatus\",\"Aphaenogaster picea\"),text.font=3,pch=16,col=c(\"red\",\"blue\"))\n#abline(v=c(46.1596629,44.7544257),lty=c(1,3),lwd=3)\n\n##plot by only slope\nplot(seq(25,70,.1),fud(T=seq(25,70,.1),slope= 0.192,Tm=45),pch=16,col=\"blue\",ylab=\"Proportion non-denatured\",xlab=\"Temperature\")\npoints(seq(25,70,.1),fud(T=seq(25,70,.1),slope= 0.216,Tm=45),pch=16,col=\"red\")\nlegend(55,1,c(\"Pogonomyrmex barbatus\",\"Aphaenogaster picea\"),text.font=3,pch=16,col=c(\"red\",\"blue\"))\n```\n\n\n#comparing 10 vs 20 min\n```{r comparing the 10 min vs 20 min at each temp, eval=FALSE}\n# 10 min inc\n#earlier\nunfold_10min<-nls.fit(ten.dat)\n# 20 min incubation\ntwen<-c(0.977,0.988,1.00,0.822,0.664,0.564,0.479,0.473,0.432,0.350,0.315,0.304)\nty.dat<-as.data.frame(cbind(T,twen));names(ty.dat)[2]<-\"unfolding\"\nunfold_20min<-nls.fit(ty.dat);unfold_20min\n\nknitr::kable(round(cbind(unfold_10min,unfold_20min),3))\n\n#plots\n\n\nplot(seq(25,70,.1),fud(T=seq(25,70,.1),max=1,min=0.3452337,Tm=43.2788185,slope=0.2824321),pch=16,col=\"red\",ylab=\"Proportion non-denatured\",xlab=\"Temperature\",ylim=c(.3,1))\npoints(seq(25,70,.1),fud(T=seq(25,70,.1),max=1,min=0.3704093,Tm=46.159662,slope=0.1923073),pch=16,col=\"black\")\npoints(ten.dat$T,ten.dat$unfolding,pch=16,col=\"black\",cex=2)\npoints(ty.dat$T,ty.dat$unfolding,pch=16,col=\"red\",cex=2)\nabline(v=c(46.1596629,43.2788185),lty=c(1,3),lwd=3)\nlegend(55,1,c(\"10 minute\",\"20 minute\"),pch=16,col=c(\"black\",\"red\"))\n\n```\n\n#How to sample a reaction norm?\n\n```{r rxn norm, eval=FALSE}\n\nunfolding<-fud(T=seq(25,70,1),Tm=45,slope=.2,min=.4)\nT<-seq(25,70,1)\ncom<-cbind(T,unfolding);head(com)\nplot(T,unfolding,ylab=\"Poportion non-denatured\",xlab=\"Temperature (C)\",las=1)\n\n#sample random points\nn<-as.data.frame(com[sample(nrow(com), 10), ])# randomly sampling\nn<-n[order(n$T),]\nn$unfolding<-n[,2]+rnorm(mean=0,sd=0.02,n=10)# adding error\n\nplot(n$T,n$unfolding,pch=16,col=\"black\",cex=2,ylim=c(.4,1))\nlines(T,unfolding)\ntt<-nls.fit(n)\ntt\nlines(seq(25,70,.1),fud(Tm=tt[2],slope=tt[1],min=tt[3],T=seq(25,70,.1)),col=\"red\",lwd=2)\nlegend(45,1,c(\"Known curve\",\"Modeled based on points\"),pch=\"-\",col=c(\"black\",\"red\"),cex=1.5)\nknitr::kable(tt)\n#mean(nndist(n$T))\n\n#try nearest neighbor\n#http://www.statsoft.com/textbook/k-nearest-neighbors\nlibrary(spatstat)\n\n\n\n\n```\n\n",
    "created" : 1464127279261.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "9|6|33|3|\n36|20|63|3|\n67|45|95|3|\n99|62|120|3|\n",
    "hash" : "3075178667",
    "id" : "EB1A9B07",
    "lastKnownWriteTime" : 1463750510,
    "path" : "~/zScience/Side_projects/2016_Protein_stability_evolution/Script_analysis/20160426_unfolding_curves_preliminary_play.Rmd",
    "project_path" : "20160426_unfolding_curves_preliminary_play.Rmd",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}